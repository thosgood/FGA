## Proof of the principal existence theorem {#fga3.v-5}

Under the conditions of \ref{fga3.v-3-theorem-3.1}, choose some module $\OO_X(1)$ that is very ample over $X/S$, and let $\xi$ be the corresponding element of $\Pic(X/S)$.
For brevity, let $\sh{P}(S')=\Pic(X\times_S S'/S')$, and suppose, for simplicity, that $X/S$ admits a section.
Let $\sh{P}^+(S')$ be the subset of $\sh{P}(S')$ consisting of classes of the $\sh{L}$ that are invertible on $X\times_S S'$ such that
$$
  \begin{aligned}
    \RR^i f'_*(\sh{L}(n)) &= 0
    \qquad\text{for }i>0\text{ and all }n\geqslant0
  \\f'_*(\sh{L}(n)) &\neq0
    \qquad\text{for all }n\geqslant0.
  \end{aligned}
$$
These conditions are stable under base change, and thus define a subfunctor $\sh{P}^+$ of $\sh{P}$ that is evidently stable under translation by $\xi$.
Using Serre's "Theorems A and B" ([[GD1960](GD1960), III, §2]) and generalities ([[Gro1960a](Gro1960a), IV, 5]), we easily see that $\sh{P}$ is representable if and only if $\sh{P}^+$ is, and so $\sh{P}^+$ will be representable by an open $U$ of the prescheme $\repPic_{X/S}$ that represents $\sh{P}$, and the latter will be an increasing union of opens $U\setminus n\xi$.

For brevity, let $\sh{D}=\shDiv_{X/S}$, and let $\sh{D}^+$ be the inverse image of $\sh{P}^+$ under the canonical morphism $\sh{D}\to\sh{P}$.
So we have a morphism

\subtree[fga3.v-5-equation-plus]{
  \taxon{equation}
  \number{+}
  ##{
    \sh{D}^+
    \to \sh{P}^+
  \startverb\tag{+}\stopverb
  }
}

and we already know that $\sh{D}^+$ is representable by an open $D^+$ of the prescheme $D=\repDiv_{X/S}$ (and, more precisely, by \em{projective bundles associated to locally free modules} that are everywhere non-zero);
this is due to the fact that, if $\sh{L}$ on $X\times_S S'$ is, as at the start of this section, then $f'_*(\sh{L})$ is a \em{locally free} non-zero module, whose formation commutes with base change;
with the notation of \ref{fga3.v-4-theorem-4.3}, $\sh{Q}$ is then isomorphic to the dual of $f'_*(\sh{L})$.
Using the general criterion ([[Gro1960a](Gro1960a), IV, 4.7]), we can thus conclude that $P^+$ is representable.
In \em{loc. cit.}, we take $\mathcal{S}$ to be the set of faithfully flat quasi-compact morphisms of preschemes (which are indeed effective epimorphisms, by [FGA 3.I, §B](fga3.i-b.1)).
\oldpage{232-13}
Condition (a) of \em{loc. cit.}, namely that \ref{fga3.v-5-equation-plus} is representable by morphisms that are elements of $\mathcal{S}$, is satisfied as we have just seen;
condition (b) says that the functor $\sh{P}^+$ is is compatible with faithfully flat quasi-compact descent, which is immediate.
It remains only to prove condition (c) of \em{loc. cit.}, namely that the equivalence $R$ in the prescheme $D^+$ induced by the $\mathcal{S}$-representable morphism ($+$) is $\mathcal{S}$-effective, i.e. is effective and such that $D^+\to D^+/R$ is in $\mathcal{S}$.
For this, note first of all that the opens ${D^+}^Q$ of $D^+$ that correspond to the virtual Hilbert polynomials $Q\in\mathbb{Q}[t]$ are stable under $R$ (since the fibres of $R$ are connected), which reduces the problem to proving that, for all $Q$, the induced equivalence relation $R^Q$ on ${D^+}^Q$ is $\mathcal{S}$-effective.
But now ${D^+}^Q$ is quasi-projective, and the equivalence relation $R^Q$ is projective and flat.
We are thus under the hypothesis of [FGA 3.III, Theorem 6.1](fga3.iii-6-theorem-6.1), which implies the desired result.

In the general case where $X/S$ does not necessarily admit a section, we can easily reduce to the above case by the technique of descent, where we can repeat the above proof with the modification that is imposed upon the definition of $\sh{P}^+$.

::: {.rmenv #fga3.v-5-remarks-5.1 title="Remarks 5.1" latex="{Remarks 5.1}"}
  The method that we followed is essentially that of Matsusaka for the projective construction of Picard varieties.
  The result that we invoke from \ref{fga3.iii} that allows us to pass to the effective quotient can also easily be deduced from the existence theorem for Hilbert schemes (cf. for example [Mumford–Tate seminar, 1962]).
  (Classically, these quotients are constructed by using Chow coordinates).
  Note that the formation of the open $\repPic_{X/S}^+$ of $\repPic_{X/S}$ and its decomposition into opens ${\repPic_{X/S}^+}^Q$ that are quasi-projcetive over $S$ following the Hilbert polynomials for the \em{divisors} that define the invertible modules in question, is compatible with base change (which allows us to apply the technique of descent).
:::

::: {.rmenv #fga3.v-5-remarks-5.2 title="Remarks 5.2" latex="{Remarks 5.2}"}
  It is not out of the question that $\repPic_{X/S}$ exist whenever $f\colon X\to S$ is proper and flat and such that the homomorphisms $k(s)\to\HH^0(X_s,\OO_{X_s})$ (for $s\in S$) are isomorphisms (this latter condition also then implying that $\OO_S\simto f_*(\OO_X)$, and that this remain true after any base change $S'\to S$).
  This at least is what we can prove in the setting of analytic spaces, if $f$ is further assumed to be projective, by a differential method (that of Chow, if I am not mistaken) explained in [[Gro1960a](Gro1960a), IX, 3.1].
  \oldpage{232-14}
  In this method, the passage to the quotient by a \em{proper} and flat equivalence relation in an open of the scheme of divisors is replaced by the passage to the quotient by the projective group in the scheme of immersions of $X$ into $\mathbb{P}_S^r$.
  This method can probably be adapted to the case of schemes, using the results of Mumford on the passage to the quotient by the projective group [[Mum1961]](Mum1961);
  for now, there is no written proof, except when $X$ has "lots of local sections" over $S$, for example if $X$ is separable over a complete local ring with algebraically closed residue field.
  In principle, the method in question is of more general scope, since it also gives the existence of Picard preschemes in the case where these are not separated, and where the first method thus necessarily fails.
  (Technically, the difficulty comes from the fact that, when the geometric fibres of $f$ are not integral, then the functor envisaged in \ref{fga3.v-4-theorem-4.3} is no longer representable by the projective bundle $\mathbb{P}(\sh{Q})$ itself, but by an \em{open} of this, which leads to the delicate question of the passage to the quotient by an equivalence relation that is flat but not proper).

  \comp
  As I point out at the start of the next talk, the existence conjecture suggested here is false, but Mumford has proven a slightly weaker theorem using his methods.
:::

::: {.rmenv #fga3.v-5-remark-5.3 title="Remark 5.3" latex="{Remark 5.3}"}
  Note that the proof given here uses neither the preliminary construction of Jacobians of curves or families of curves nor the theory of abelian varieties or abelian schemes, and in this way it essentially distinguishes itself from traditional treatments, such as those in the book by Lang [[Lan1959]](Lan1959) or the article by Chevalley [[Che1960]](Che1960), which follow the path sketched by Weil.
  Even in the case of Jacobians of non-singular curves over an algebraically closed field (the complex numbers, say), the construction given here for the Jacobian is the only one known that comes with the very strong properties that we took as definition in \ref{fga3.v-1} (essentially those of Chevalley, but taking into account the "variety of parameters" with nilpotent elements).
  The fact that the construction of Picard schemes should precede, not follow, the theory of abelian varieties is clear a priori, by the fact that, in general, Picard schemes are not, nor do they reduce to, abelian schemes, as we already see in the case of singular curves over an algebraically closed field, where we find the "generalised Jacobians" of Rosenlicht, which are not abelian varieties.
  Furthermore, the theory of abelian varieties, and more generally of abelian schemes, becomes much simpler once we have a theory of Picard schemes in general.
  In particular, the theory of duality for abelian schemes, and notably the results of Cartier type, then become slightly more formal (cf. for example [Mumford–Tate seminar, 1962]).
:::

::: {.rmenv #fga3.v-5-remarks-5.4 title="Remarks 5.4" latex="{Remarks 5.4}"}
  \oldpage{232-15}
  The "compatibility principle" of Igusa for the Jacobian of a curve degenerating to a singular curve can only be well understood as an existence theorem of the Picard scheme of a relative scheme in curves $X/S$ that are not necessarily simple over $S$.
  This is thus a particular case of the principal existence theorem \ref{fga3.v-3-theorem-3.1} when the specialised curve is integral (i.e. in classical terms, irreducible of multiplicity $1$).
  We note that, for now, the case of a reducible special curve (even when the components are of multiplicity $1$, i.e. when the special curve is separable over the residue field) is not covered by the known existence theorems, except for in the case where we are over a \em{complete} discrete valuation ring with algebraically closed residue field, cf. \ref{fga3.v-5-remarks-5.2}.
  This question of existence certainly arises in a geometric construction, in the theory of schemes, of Baily–Satake "compactifications" of modular schemes of curves of genus $g$.
  (This compactification is known for now only for $g=1$, thanks to work of Igusa).
:::


## Relative existence theorems {#fga3.v-6}

We will sketch here some useful cases where the existence of certain Picard schemes implies the existence of certain others, which allows us to deduce from the principal existence theorem \ref{fga3.v-3-theorem-3.1} various other existence theorems.

::: {.itenv #fga3.v-6-proposition-6.1 title="Proposition 6.1" latex="{Proposition 6.1}"}
  Let $f\colon X\to S$ be a flat projective morphism such that, in the Stein factorisation $f=f''f'$, the morphism $f'\colon X\to S'$ is \em{flat} and has integral geometric fibres (and thus satisfies the hypotheses of \ref{fga3.v-3-theorem-3.1}), and such that the finite morphism $f''\colon S'\to$ is flat.
  Then $\repPic_{X/S}$ exists and (with the notation introduced in [FGA 3.II, §C.2](fga3.ii-c.2)) we have a canonical isomorphism
  $$
    \repPic_{X/S}
    \simto \prod_{S'/S} \repPic_{X/S'}.
  $$
:::

::: {.proof}
    To prove this, we first establish an isomorphism of functors
    $$
      \shPic_{X/S}
      \simto \prod_{S'/S} \shPic_{X/S'}
    $$
    and then use \ref{fga3.v-3-theorem-3.1}, which implies that $\shPic_{X/S'}$ is representable;
    we use the structure explained in \ref{fga3.v-3} of $\repPic_{X/S'}$ (which implies that every finite subset of a fibre of $\repPic_{X/S'}$ over $S$ is contained in an affine open) for the existence of $\prod_{S'/S}\repPic_{X/S'}$.
:::

\oldpage{232-16}
For example, if $X$ is a scheme given by a \em{sum} of schemes $X_i$ over $S$ that satisfy the conditions of \ref{fga3.v-3-theorem-3.1}, then the statement of \ref{fga3.v-6-proposition-6.1} reduces to the trivial statement
$$
  \repPic_{X/S}
  \simto \prod_i \repPic_{X_i/S}.
$$

::: {.itenv #fga3.v-6-corollary-6.2 title="Corollary 6.2" latex="{Corollary 6.2}"}
  Let $f\colon X\to S$ be a projective flat morphism with locally integral geometric fibres (for example, a projective and normal morphism).
  Then $\repPic_{X/S}$ exists.
:::

::: {.proof}
    In this case, $S'$ is an étale covering of $S$ (which is true once $f$ is separable, i.e. flat with reduced geometric fibres), and we see that the structure theorem stated in \ref{fga3.v-3} for $\repPic_{X/S}$ still holds, thanks to the analogous structure of $\repPic_{X/S'}$.
:::

Applying a descent procedure gives a relative existence theorem, whose scope depends on the solution to questions about non-flat descent that were raised in [FGA 3.I, §A.2.c](fga3.i-a.2.c), and of which we content ourselves here to explain only a particular case:

::: {.itenv #fga3.v-6-proposition-6.3 title="Proposition 6.3" latex="{Proposition 6.3}"}
  Let $f\colon X\to S$ be a proper morphism, and let $X_1$ and $X_2$ be subpreschemes of $X$ that are flat over $S$, defined by coherent ideals $\sh{J}_1$ and $\sh{J}_2$ (respectively) such that $\sh{J}_1\cap\sh{J}_2=(0)$ and such that $\OO_X/(\sh{J}_1+\sh{J}_2)$ is flat over $S$ (i.e. the subprescheme of $X$ that is the sup of $X_1$ and $X_2$ is $X$ itself, whereas their inf $Z$ is flat over $X$).
  Suppose further that, for all $s\in S$, the homomorphisms $k(s)\to\HH^0(X_{i_s},\OO_{X_{i_s}})$ are bijective for $i=1,2$.
  Then the natural homomorphism of functors
  $$
    \shPic_{X/S}
    \to \shPic_{X_1/S} \times \shPic_{X_2/S}
  $$
  is representable by affine morphisms, so if $\repPic_{X_1/S}$ and $\repPic_{X_2/s}$ exist, then so too does $\repPic_{X/S}$, and the canonical morphism
  $$
    \repPic_{X/S}
    \to \repPic_{X_1/S} \times \repPic_{X_2/S}
  $$
  is affine.
:::

::: {.proof}
    By faithfully flat descent, we can reduce to the case where $Z$ admits a section over $S$, thus defining sections of $X$, $X_1$, and $X_2$ over $S$, and allowing us to eliminate the automorphisms in the structures in question, as explained in \ref{fga3.v-2-remark-2.5}.
    \oldpage{232-17}
    The proof then consists of noting that the data of a "rigidified" invertible module $\sh{L}$ on $X$ is equivalent to the data of a triple $(\sh{L}_1,\sh{L}_2,u)$, where $\sh{L}_i$ is a "rigidified" module on $X_i$, and $u$ is an isomorphism from $\sh{L}_1|Z$ to $\sh{L}_2|Z$ that is compatible with the rigidifications.
    It remains only to verify that, for $\sh{L}_1$ and $\sh{L}_2$ fixed, the data of $u$ can be expressed as a section of a suitable scheme over $S$ that is affine over $S$, which is easy.
:::

From \ref{fga3.v-6-proposition-6.3} we easily conclude:

::: {.itenv #fga3.v-6-corollary-6.4 title="Corollary 6.4" latex="{Corollary 6.4}"}
  Let $X$ be a proper and separable scheme over a field $k$, and let $X_i$ be the irreducible components of $X$.
  If the $\repPic_{X_i/k}$ exist, then so too does $\repPic_{X/k}$, and the canonical morphism
  $$
    \repPic_{X/k}
    \to \prod_i \repPic_{X_i/k}
  $$
  is affine.
:::

Combined with \ref{fga3.v-6-corollary-6.2}, this shows, for example, the existence of $\repPic_{X/k}$ whenever $X$ is a projective scheme that is separable over a field $k$.
If $X$ is no longer separable over $k$, then we equally have a reduction result, using the argument of Oort [[Oor1962]](Oor1962).
The method equally applies for a scheme with arbitrary base (a useful case, for example, in proving in the following talk the finiteness result stated in \ref{fga3.v-remark-3.3}).
To avoid an overly technical statement, we restrict ourselves to the case where we are over a base field:

::: {.itenv #fga3.v-6-proposition-6.5 title="Proposition 6.5" latex="{Proposition 6.5}"}
  Let $X$ be a proper scheme over a field $k$, and $X_0$ a subscheme that has the same underlying set (thus defined by a nilpotent ideal on $X$).
  Then the functorial morphism $\shPic_{X/k}\to\shPic_{X_0/k}$ is representable by affine morphisms.
  In particular, if $\repPic_{X_0/k}$ exists, then so too does $\repPic_{X/k}$, and the morphism $\repPic_{X/k}\to\repPic_{X_0/k}$ is affine.
:::

Combining this with \ref{fga3.v-6-corollary-6.4}, we easily conclude:

::: {.itenv #fga3.v-6-corollary-6.6 title="Corollary 6.6" latex="{Corollary 6.6}"}
  Let $X$ be a projective prescheme over a field $k$>
  Then $\repPic_{X/k}$ exists.
:::

::: {.rmenv #fga3.v-6-remark-6.6 title="Remark 6.6" latex="{Remark 6.6}"}
  It is extremely plausible that, for every \em{proper} scheme $X$ over a field $k$, $\repPic_{X/k}$ exists.
  The results above allow us to reduce, for this question, to the case where $k$ is algebraically closed, and where $X$ is integral.
  We then know that there exists an integral scheme $X'$ that is \em{projective} over $k$, and a dominant morphism $g\colon X'\to X$ (Chow's lemma).
  \oldpage{232-18}
  It would thus suffice to show that the corresponding functorial morphism $\shPic_{X/k}\to\shPic_{X'/k}$ is representable (and, probably, representable by affine morphisms), since we already know that $\shPic_{X'/k}$ is representable.
  This raises questions about non-flat descent that are not answerable as of now.
  Note that, if we restrict to considering the restriction of the functor $\shPic_{X/k}$ to reduced preschemes (with $X$ proper and integral over an algebraically closed field $k$), then we do indeed obtain a representable functor, as shown by Chevalley [[Che1960]](Che1960) in the case where $X$ is normal, and by Seshadri [[Ses1962]](Ses1962) by a descent method in the general case.
  But with our notation, the scheme constructed by these authors is not $\repPic_{X/k}$, but instead $(\repPic_{X/k})_\red$, i.e. the reduced scheme corresponding to $\repPic_{X/k}$.

  \comp
  As we point out at the start of the next talk, the question raised here has just been answered in the affirmative by Murre.
:::

::: {.rmenv #fga3.v-6-remark-6.7 title="Remark 6.7" latex="{Remark 6.7}"}
  More generally, let $f\colon X'\to X$ be a surjective morphism of proper preschemes over $k$.
  Then considering non-flat descent leads us to conjecture that $\repPic_{X/k}\to\repPic_{X'/k}$ is an \em{affine} morphism, which would in particular imply (by dividing into the connected components of the identity elements) that the corresponding homomorphism on the Néron–Severi groups is injective modulo torsion.
  We can verify this by the theory of intersections when $X$ and $X'$ are non-singular.
  The answer does not seem to be known in any other case.

  \comp
  The question raised here has been answered in the affirmative (cf. the last paragraph of the comments in the next talk).
:::

::: {.rmenv #fga3.v-6-remark-6.8 title="Remark 6.8" latex="{Remark 6.8}"}
  Contrary to what we might think, the consideration of Picard schemes of algebraic schemes with nilpotent elements is useful, and even indispensable, for various questions.
  If $X$ is a projective scheme, simple over $k$, say, and $Y$ a hyperplane section, then we can consider the "infinitesimal neighbourhoods" $X_n$ of $Y$ of all orders, as well as the Picard schemes $\repPic_{X_n/k}$;
  when $X$ is irreducible of dimension $\geqslant4$ (resp. $\geqslant3$), the canonical morphism
  $$
    \repPic_{X/k}
    \to\repPic_{X_n/k}
    \qquad\text{for large }n
  $$
  is an isomorphism (resp. induces an isomorphism between the inverse images of the torsion subgroups of the Néron–Severi groups), and this result will be useful in the qualitative study of Picard schemes in the following talk.
  Similarly, the consideration of Picard schemes of certain curves with nilpotent elements and the fundamental theorems of formal geometry [[Gro1958a]](Gro1958a) allow us to prove, in the case of equal characteristic, a conjecture of Mumford, namely that for every complete normal Noetherian local ring $A$ of dimension $2$, the group of classes of divisors of $A$ can be considered as the set of rational points over $k$ of an algebraic group $G$ over the residue field $k$ (with $G$ being canonically determined once we have a field of representatives in $A$).
  \oldpage{232-19}
  In the case where $A$ is of arbitrary dimension, it is plausible that there exists an algebraic pro-group over $k$ that plays the same role as $G$ above, which is constructed, in the case where we can "desingularise" $\Spec(A)$, as a projective limit of Picard schemes of suitable projective schemes (with nilpotent elements) over $k$.
:::
